<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sentiment Intelligence Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--bg:#0f172a;
--panel:#111827;
--card:#1f2937;
--accent:#6366f1;
--green:#22c55e;
--red:#ef4444;
--yellow:#eab308;
--text:#e5e7eb;
}

*{box-sizing:border-box}

body{
margin:0;
font-family:Inter,Segoe UI,Arial;
background:var(--bg);
color:var(--text);
}

/* Header */
.header{
padding:18px 40px;
font-size:22px;
font-weight:600;
background:#020617;
border-bottom:1px solid #1f2937;
}

/* Layout */
.wrapper{
display:grid;
grid-template-columns: 1fr 340px;
gap:24px;
padding:30px 40px;
}

/* Panels */
.panel{
background:var(--panel);
border-radius:14px;
padding:22px;
box-shadow:0 10px 25px rgba(0,0,0,.4);
}

/* Inputs */
textarea{
width:100%;
height:120px;
border-radius:10px;
border:1px solid #374151;
background:#020617;
color:white;
padding:12px;
font-size:14px;
}

button{
margin-top:12px;
padding:12px 22px;
border:none;
border-radius:10px;
background:var(--accent);
color:white;
cursor:pointer;
font-weight:500;
transition:.2s;
}
button:hover{transform:translateY(-1px);background:#4f46e5}

/* Result Badge */
.badge{
margin-top:18px;
padding:14px;
border-radius:10px;
font-weight:600;
font-size:18px;
display:none;
}
.pos{background:rgba(34,197,94,.15);color:var(--green)}
.neg{background:rgba(239,68,68,.15);color:var(--red)}
.neu{background:rgba(234,179,8,.15);color:var(--yellow)}

/* Progress */
.bar{height:12px;background:#020617;border-radius:8px;margin-top:14px}
.fill{height:100%;width:0;background:var(--accent);border-radius:8px}

/* Stats cards */
.cards{
display:grid;
grid-template-columns:repeat(3,1fr);
gap:14px;
margin-top:20px;
}
.card{
background:var(--card);
padding:16px;
border-radius:12px;
text-align:center;
font-size:14px;
}
.card span{font-size:22px;font-weight:600}

/* History */
.history{
margin-top:18px;
max-height:180px;
overflow:auto;
font-size:13px;
}
.history li{
padding:6px 0;
border-bottom:1px solid #1f2937;
}

/* Toast */
.toast{
position:fixed;
bottom:25px;
right:25px;
background:#111827;
padding:14px 20px;
border-radius:10px;
opacity:0;
transform:translateY(20px);
transition:.4s;
}
.toast.show{opacity:1;transform:translateY(0)}
</style>
</head>

<body>

<div class="header">üß† Sentiment Intelligence Dashboard</div>

<div class="wrapper">

<!-- LEFT SIDE -->
<div class="panel">

<h3>Single Text Analysis</h3>
<textarea id="text" placeholder="Type review or feedback..."></textarea>
<button onclick="analyze()">Analyze</button>

<div id="resultBox" class="badge"></div>
<div class="bar"><div id="confidenceBar" class="fill"></div></div>
<p id="confidenceText"></p>

<div class="cards">
<div class="card">Positive<br><span id="posCount">0</span></div>
<div class="card">Negative<br><span id="negCount">0</span></div>
<div class="card">Neutral<br><span id="neuCount">0</span></div>
</div>

</div>

<!-- RIGHT SIDE -->
<div class="panel">

<h3>Bulk CSV Analysis</h3>
<input type="file" id="csvfile">
<button onclick="analyzeCSV()">Analyze CSV</button>

<canvas id="chart" height="180"></canvas>

<h4>Recent Activity</h4>
<ul id="history" class="history"></ul>

</div>

</div>

<div id="toast" class="toast">Processing...</div>

<script>
const API_BASE="http://127.0.0.1:8000";

let stats={POSITIVE:0,NEGATIVE:0,NEUTRAL:0};

const chart=new Chart(document.getElementById('chart'),{
type:'doughnut',
data:{
labels:['Positive','Negative','Neutral'],
datasets:[{data:[0,0,0],backgroundColor:['#22c55e','#ef4444','#eab308']}]
}
});

function showToast(msg){
const t=document.getElementById("toast");
t.innerText=msg;
t.classList.add("show");
setTimeout(()=>t.classList.remove("show"),2500);
}

function emoji(l){return l=="POSITIVE"?"üòä":l=="NEGATIVE"?"üò°":"üòê";}

async function analyze(){
const text=document.getElementById("text").value;
if(!text)return showToast("Enter text first");

showToast("Analyzing...");

const form=new FormData();
form.append("text",text);

const res=await fetch(`${API_BASE}/analyze`,{method:"POST",body:form});
const data=await res.json();

const box=document.getElementById("resultBox");
box.style.display="block";
box.className="badge "+(data.label=="POSITIVE"?"pos":data.label=="NEGATIVE"?"neg":"neu");
box.innerText=emoji(data.label)+" "+data.label;

document.getElementById("confidenceBar").style.width=data.score+"%";
document.getElementById("confidenceText").innerText="Confidence "+data.score+"%";

stats[data.label]++;
updateStats();
updateChart();
addHistory(text,data.label);
}

async function analyzeCSV(){
const file=document.getElementById("csvfile").files[0];
if(!file)return showToast("Upload CSV");

showToast("Processing CSV...");

const form=new FormData();
form.append("file",file);

const res=await fetch(`${API_BASE}/analyze_csv`,{method:"POST",body:form});
const data=await res.json();

stats=data.stats;
updateStats();
updateChart();

showToast("CSV Analysis Completed");
}

function updateStats(){
posCount.innerText=stats.POSITIVE;
negCount.innerText=stats.NEGATIVE;
neuCount.innerText=stats.NEUTRAL;
}

function updateChart(){
chart.data.datasets[0].data=[stats.POSITIVE,stats.NEGATIVE,stats.NEUTRAL];
chart.update();
}

function addHistory(text,label){
const li=document.createElement("li");
li.innerText=text+" ‚Üí "+label;
history.prepend(li);
}
</script>

</body>
</html>
